<!DOCTYPE html>
<html class="writer-html5" lang="python">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Taweret.core namespace &mdash; Taweret 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Taweret.mix namespace" href="Taweret.mix.html" />
    <link rel="prev" title="Taweret package" href="Taweret.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Taweret
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">About Taweret:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Taweret for Bayesian Model Mixing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Installation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="macos_user.html">MacOS Users</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Taweret</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="Taweret.html">Taweret package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="Taweret.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">Taweret.core namespace</a></li>
<li class="toctree-l4"><a class="reference internal" href="Taweret.mix.html">Taweret.mix namespace</a></li>
<li class="toctree-l4"><a class="reference internal" href="Taweret.models.html">Taweret.models namespace</a></li>
<li class="toctree-l4"><a class="reference internal" href="Taweret.sampler.html">Taweret.sampler namespace</a></li>
<li class="toctree-l4"><a class="reference internal" href="Taweret.utils.html">Taweret.utils namespace</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Taweret.html#module-Taweret">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="notebooks/Linear_BMM_with_cdf_function_for_coleman_models.html">Linear Bivariate BMM with calibration of Coleman toy models.</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/coleman_models_BMM_comparative_study.html">Comparative study of BMM method in bivariate linear module using Coleman toy models.</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/Linear_BMM_with_step_function_for_SAMBA_models.html">Linear Bivariate BMM with SAMBA toy models : step mixing</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/Linear_BMM_with_cdf_function_for_SAMBA_models.html">Linear Bivariate BMM with SAMBA toy models : cdf mixing</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/Linear_BMM_with_switchcos_function_for_SAMBA_models.html">Linear Bivariate BMM with SAMBA toy models : switchcos mixing</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/Bivariate_Test.html">Bivariate BMM Test</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/N_Model_BMM.html">Multivariate BMM for n = 3, …, N models</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/Trees_BMM_2D.html">BART BMM: 2D Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/Trees_BMM_2D_K_models.html">BART BMM: 2D Inputs with K Models</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For Developers:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="how_to_add_new_mixing.html">How to add a new mixing method to Taweret</a></li>
<li class="toctree-l1"><a class="reference internal" href="how_to_add_documentation.html">How to update documentation in Taweret website</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Taweret</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">Taweret</a></li>
          <li class="breadcrumb-item"><a href="Taweret.html">Taweret package</a></li>
      <li class="breadcrumb-item active">Taweret.core namespace</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/Taweret.core.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-Taweret.core">
<span id="taweret-core-namespace"></span><h1>Taweret.core namespace<a class="headerlink" href="#module-Taweret.core" title="Permalink to this heading"></a></h1>
<section id="module-Taweret.core.base_mixer">
<span id="submodules"></span><h2>Submodules<a class="headerlink" href="#module-Taweret.core.base_mixer" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="Taweret.core.base_mixer.BaseMixer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Taweret.core.base_mixer.</span></span><span class="sig-name descname"><span class="pre">BaseMixer</span></span><a class="reference internal" href="_modules/Taweret/core/base_mixer.html#BaseMixer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.core.base_mixer.BaseMixer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="Taweret.core.base_mixer.BaseMixer.evaluate">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/core/base_mixer.html#BaseMixer.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.core.base_mixer.BaseMixer.evaluate" title="Permalink to this definition"></a></dt>
<dd><p>Calculate a point estimate for mixing model</p>
<dl class="simple">
<dt>evaluation<span class="classifier">float</span></dt><dd><p>point estimate from mixing model</p>
</dd>
</dl>
<p>Global linear mixing:</p>
<div class="math notranslate nohighlight">
\[f_\mathrm{mixed} = \sum_{i=1}^N w_i \mathcal M_i(\theta_i)\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyMixer</span><span class="p">(</span><span class="n">BaseMixer</span><span class="p">):</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">models</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_list</span>
    <span class="nd">@models</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_list</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_model_list</span> <span class="o">=</span> <span class="n">model_list</span>
    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">model_parameters</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_model_list</span><span class="p">)):</span>
            <span class="n">value</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_list</span><span class="p">[</span><span class="n">i</span><span class="p">](</span>
                <span class="n">x</span><span class="p">,</span> <span class="n">model_parameters</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="p">)</span> <span class="o">*</span> <span class="n">weight</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">value</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Taweret.core.base_mixer.BaseMixer.evaluate_weights">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">evaluate_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/core/base_mixer.html#BaseMixer.evaluate_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.core.base_mixer.BaseMixer.evaluate_weights" title="Permalink to this definition"></a></dt>
<dd><p>Calculate or sample a point estimate for model weights</p>
<dl class="simple">
<dt>weights<span class="classifier">np.ndarray</span></dt><dd><p>array of the evaluations or samples of weights</p>
</dd>
</dl>
<p>Global linear mixing:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy</span>
<span class="k">class</span> <span class="nc">MyMixer</span><span class="p">(</span><span class="n">BaseMixer</span><span class="p">):</span>
    <span class="c1"># . . .</span>
    <span class="k">def</span> <span class="nf">evaluate_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dirichlet_params</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">dirichlet</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">dirichlet_params</span><span class="p">)</span>
    <span class="c1"># . . .</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="Taweret.core.base_mixer.BaseMixer.map">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">map</span></span><a class="headerlink" href="#Taweret.core.base_mixer.BaseMixer.map" title="Permalink to this definition"></a></dt>
<dd><p>Stores the MAP values for the posterior distributions and is set
during the self.train step</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="Taweret.core.base_mixer.BaseMixer.posterior">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">posterior</span></span><a class="headerlink" href="#Taweret.core.base_mixer.BaseMixer.posterior" title="Permalink to this definition"></a></dt>
<dd><p>Stores the most recent posteriors from running self.train function</p>
<dl class="simple">
<dt>_posterior<span class="classifier">np.ndarray</span></dt><dd><p>posterior from learning the weights</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Taweret.core.base_mixer.BaseMixer.predict">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/core/base_mixer.html#BaseMixer.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.core.base_mixer.BaseMixer.predict" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate posterior to make prediction at test points.</p>
<dl class="simple">
<dt>evaluated_posterior<span class="classifier">np.ndarray</span></dt><dd><p>array of posterior predictive distribution evaluated at provided
test points</p>
</dd>
<dt>mean<span class="classifier">np.ndarray</span></dt><dd><p>average mixed model value at each provided test points</p>
</dd>
<dt>credible_intervals<span class="classifier">np.ndarray</span></dt><dd><p>intervals corresponding for 60%, 90% credible intervals</p>
</dd>
<dt>std_dev<span class="classifier">np.ndarray</span></dt><dd><p>sample standard deviation of mixed model output at provided test
points</p>
</dd>
</dl>
<p>Global liner mixing:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyMixer</span><span class="p">(</span><span class="n">BaseMixer</span><span class="p">):</span>
    <span class="c1"># . . .</span>
    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_test</span><span class="p">):</span>
        <span class="c1"># work to calculate everything</span>
        <span class="c1"># . . .</span>
        <span class="k">return</span> <span class="n">posterior</span><span class="p">,</span> <span class="n">means</span><span class="p">,</span> <span class="n">credible_intervals</span><span class="p">,</span> <span class="n">std_dev</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Taweret.core.base_mixer.BaseMixer.predict_weights">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">predict_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/core/base_mixer.html#BaseMixer.predict_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.core.base_mixer.BaseMixer.predict_weights" title="Permalink to this definition"></a></dt>
<dd><p>Calculate posterior predictive distribution for model weights</p>
<dl class="simple">
<dt>evaluated_posterior<span class="classifier">np.ndarray</span></dt><dd><p>array of posterior predictive distribution evaluated at provided
test points</p>
</dd>
<dt>mean<span class="classifier">np.ndarray</span></dt><dd><p>average mixed model value at each provided test points</p>
</dd>
<dt>credible_intervals<span class="classifier">np.ndarray</span></dt><dd><p>intervals corresponding for 60%, 90% credible intervals</p>
</dd>
<dt>std_dev<span class="classifier">np.ndarray</span></dt><dd><p>sample standard deviation of mixed model output at provided test
points</p>
</dd>
</dl>
<p>Global liner mixing:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyMixer</span><span class="p">(</span><span class="n">BaseMixer</span><span class="p">):</span>
    <span class="c1"># . . .</span>
    <span class="k">def</span> <span class="nf">predict_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_test</span><span class="p">):</span>
        <span class="c1"># work to calculate everything</span>
        <span class="c1"># . . .</span>
        <span class="k">return</span> <span class="n">posterior</span><span class="p">,</span> <span class="n">means</span><span class="p">,</span> <span class="n">credible_intervals</span><span class="p">,</span> <span class="n">std_dev</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="Taweret.core.base_mixer.BaseMixer.prior">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">prior</span></span><a class="headerlink" href="#Taweret.core.base_mixer.BaseMixer.prior" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary of prior distributions. Format should be compatible with
sampler.</p>
<dl class="simple">
<dt>_prior<span class="classifier">Dict[str, Any]</span></dt><dd><p>Underlying prior object(s)</p>
</dd>
</dl>
<p>Please consult <code class="docutils literal notranslate"><span class="pre">BaseMixer.set_prior</span></code> for an example</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Taweret.core.base_mixer.BaseMixer.prior_predict">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">prior_predict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/core/base_mixer.html#BaseMixer.prior_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.core.base_mixer.BaseMixer.prior_predict" title="Permalink to this definition"></a></dt>
<dd><p>Get prior predictive distribution and prior distribution samples</p>
<dl class="simple">
<dt>evaluated_prior<span class="classifier">np.ndarray</span></dt><dd><p>array of prior predictive distribution evaluated at provided
test points</p>
</dd>
<dt>mean<span class="classifier">np.ndarray</span></dt><dd><p>average mixed model value at each provided test points</p>
</dd>
<dt>credible_intervals<span class="classifier">np.ndarray</span></dt><dd><p>intervals corresponding for 60%, 90% credible intervals</p>
</dd>
<dt>std_dev<span class="classifier">np.ndarray</span></dt><dd><p>sample standard deviation of mixed model output at provided test
points</p>
</dd>
</dl>
<p>Global liner mixing:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyMixer</span><span class="p">(</span><span class="n">BaseMixer</span><span class="p">):</span>
    <span class="c1"># . . .</span>
    <span class="k">def</span> <span class="nf">prior_predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_test</span><span class="p">):</span>
        <span class="c1"># work to calculate everything</span>
        <span class="c1"># . . .</span>
        <span class="k">return</span> <span class="n">prior</span><span class="p">,</span> <span class="n">means</span><span class="p">,</span> <span class="n">credible_intervals</span><span class="p">,</span> <span class="n">std_dev</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Taweret.core.base_mixer.BaseMixer.set_prior">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_prior</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/core/base_mixer.html#BaseMixer.set_prior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.core.base_mixer.BaseMixer.set_prior" title="Permalink to this definition"></a></dt>
<dd><p>User must provide function that sets a member varibale called
<code class="docutils literal notranslate"><span class="pre">_prior</span></code>.
Dictionary of prior distributions. Format should be compatible with
sampler.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyMixer</span><span class="p">(</span><span class="n">BaseMixer</span><span class="p">):</span>
    <span class="c1"># . . .</span>
    <span class="k">def</span> <span class="nf">set_prior</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior_dict</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prior</span> <span class="o">=</span> <span class="n">prior_dict</span>
    <span class="c1"># . . .</span>
<span class="c1"># creating a bilby prior dict</span>
<span class="n">priors</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">priors</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bilby</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">prior</span><span class="o">.</span><span class="n">MultivariateGaussian</span><span class="p">(</span><span class="n">mvg</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="n">priors</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bilby</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">prior</span><span class="o">.</span><span class="n">MultivariateGaussian</span><span class="p">(</span><span class="n">mvg</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MyMixer</span><span class="p">()</span>
<span class="n">m</span><span class="o">.</span><span class="n">set_prior</span><span class="p">(</span><span class="n">prior_dict</span><span class="o">=</span><span class="n">priors</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Taweret.core.base_mixer.BaseMixer.train">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/core/base_mixer.html#BaseMixer.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.core.base_mixer.BaseMixer.train" title="Permalink to this definition"></a></dt>
<dd><p>Run sampler to learn parameters. Method should also create class
members that store the posterior and other diagnostic quantities
import for plotting
MAP values should also caluclate and set as member variable of
class</p>
<dl class="simple">
<dt>_posterior<span class="classifier">np.ndarray</span></dt><dd><p>the mcmc chain return from sampler</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-Taweret.core.base_model"></span><dl class="py class">
<dt class="sig sig-object py" id="Taweret.core.base_model.BaseModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Taweret.core.base_model.</span></span><span class="sig-name descname"><span class="pre">BaseModel</span></span><a class="reference internal" href="_modules/Taweret/core/base_model.html#BaseModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.core.base_model.BaseModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="Taweret.core.base_model.BaseModel.evaluate">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/core/base_model.html#BaseModel.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.core.base_model.BaseModel.evaluate" title="Permalink to this definition"></a></dt>
<dd><p>Calculate a point estimate for mixing model</p>
<dl class="simple">
<dt>evaluation<span class="classifier">float</span></dt><dd><p>point estimate for model</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model</span>

    <span class="nd">@models</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">the_model</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_model</span> <span class="o">=</span> <span class="n">the_model</span>

    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_parameters</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model</span><span class="p">(</span><span class="n">model_parameters</span><span class="p">)</span>
    <span class="c1"># . . .</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Taweret.core.base_model.BaseModel.log_likelihood_elementwise">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">log_likelihood_elementwise</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/core/base_model.html#BaseModel.log_likelihood_elementwise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.core.base_model.BaseModel.log_likelihood_elementwise" title="Permalink to this definition"></a></dt>
<dd><p>Calculate log_likelihood for array of points given, and return with
array with same shape[0]</p>
<dl class="simple">
<dt>log_likelis<span class="classifier">np.ndarray</span></dt><dd><p>an array of length as shape[0] of the input evaluation points</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">log_likelihood_elementwise</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">y_exp</span><span class="p">,</span> <span class="n">y_err</span><span class="p">,</span> <span class="n">model_params</span>
    <span class="p">):</span>
        <span class="c1"># Assuming a normal distribution for error</span>
        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">model_params</span><span class="p">)</span>
        <span class="c1"># If y_exp, y_err, y are numpy arrays of same length</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">y_exp</span><span class="p">)</span> <span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y_err</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> \
            <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">y_err</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Taweret.core.base_model.BaseModel.set_prior">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_prior</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/core/base_model.html#BaseModel.set_prior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.core.base_model.BaseModel.set_prior" title="Permalink to this definition"></a></dt>
<dd><p>User must provide function that sets a member varibale called _prior.
Dictionary of prior distributions. Format should be compatible with
sampler.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">BaseMixer</span><span class="p">):</span>
    <span class="c1"># . . .</span>
    <span class="k">def</span> <span class="nf">set_prior</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior_dict</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prior</span> <span class="o">=</span> <span class="n">prior_dict</span>
    <span class="c1"># . . .</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<span class="target" id="module-Taweret.core.trees_setup"></span><p>Name: trees_setup.py
Author: John Yannotty (<a class="reference external" href="mailto:yannotty&#46;1&#37;&#52;&#48;osu&#46;edu">yannotty<span>&#46;</span>1<span>&#64;</span>osu<span>&#46;</span>edu</a>)
Desc: Setups up working environment for mixing classes</p>
<p>Start Date: 11/28/22
Version: 1.0</p>
<dl class="py function">
<dt class="sig sig-object py" id="Taweret.core.trees_setup.trees_setup">
<span class="sig-prename descclassname"><span class="pre">Taweret.core.trees_setup.</span></span><span class="sig-name descname"><span class="pre">trees_setup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/core/trees_setup.html#trees_setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.core.trees_setup.trees_setup" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Taweret.html" class="btn btn-neutral float-left" title="Taweret package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Taweret.mix.html" class="btn btn-neutral float-right" title="Taweret.mix namespace" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Dan Liyanage, Alexandra Semposki, John Yannotty, Kevin Ingles.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>